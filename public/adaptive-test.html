<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SkillForge Adaptive Test</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Inter',sans-serif}

body{
  background: radial-gradient(circle at 20% 20%, #0f172a, #020617);
  color:white;
  min-height:100vh;
  padding:40px;
}

body.light-mode{
  background:#f1f5f9;
  color:#0f172a;
}

.container{
  max-width:800px;
  margin:auto;
}

.question-box{
  background:rgba(255,255,255,0.05);
  padding:30px;
  border-radius:20px;
  margin-bottom:20px;
}

.options label{
  display:block;
  margin:8px 0;
  cursor:pointer;
}

button{
  margin-top:20px;
  padding:10px 18px;
  border:none;
  border-radius:8px;
  background:linear-gradient(90deg,#06b6d4,#3b82f6);
  color:white;
  cursor:pointer;
}

.result-box{
  display:none;
  margin-top:30px;
}

canvas{
  margin-top:30px;
}
</style>
</head>

<body>

<div class="container">

<h1>Adaptive Skill Assessment</h1>

<div id="testArea"></div>

<button id="submitBtn">Submit Test</button>

<div class="result-box" id="resultBox">
  <h2>Your Performance</h2>
  <p id="scoreText"></p>

  <canvas id="barChart"></canvas>
  <canvas id="radarChart"></canvas>

  <button onclick="window.location.href='dashboard.html'">
    Back to Dashboard
  </button>
</div>

</div>

<script>

// ðŸ” PAGE PROTECTION
const token = localStorage.getItem("token");
if(!token){
  window.location.href="index.html";
}

// ðŸŒ™ THEME
if(localStorage.getItem("theme")==="light"){
  document.body.classList.add("light-mode");
}

// ================= QUESTIONS =================

const questions = [
{q:"What is supervised learning?", options:["Learning without labels","Learning with labeled data","Random guessing","None"], answer:1, domain:"ML"},
{q:"Activation function used in hidden layers?", options:["ReLU","Linear","Softmax","None"], answer:0, domain:"DL"},
{q:"What is overfitting?", options:["High bias","High variance","Under training","None"], answer:1, domain:"ML"},
{q:"What does NLP stand for?", options:["Natural Logic Processing","Neural Language Program","Natural Language Processing","None"], answer:2, domain:"NLP"},
{q:"Gradient descent minimizes?", options:["Loss function","Accuracy","Data","None"], answer:0, domain:"Math"},
{q:"CNN mainly used for?", options:["Text","Images","Audio","None"], answer:1, domain:"DL"},
{q:"Tokenizer used in NLP?", options:["Split text","Remove image","Encrypt","None"], answer:0, domain:"NLP"},
{q:"What is derivative?", options:["Rate of change","Area","Sum","None"], answer:0, domain:"Math"},
{q:"Python used for AI because?", options:["Simple syntax","Low memory","Game dev","None"], answer:0, domain:"Coding"},
{q:"Epoch in training means?", options:["One full pass","Half pass","Error","None"], answer:0, domain:"DL"}
];

// ================= RENDER QUESTIONS =================

const testArea = document.getElementById("testArea");

questions.forEach((item,index)=>{
  const box = document.createElement("div");
  box.className="question-box";

  let optionsHTML="";
  item.options.forEach((opt,i)=>{
    optionsHTML+=`
      <label>
        <input type="radio" name="q${index}" value="${i}">
        ${opt}
      </label>
    `;
  });

  box.innerHTML=`
    <h3>Q${index+1}. ${item.q}</h3>
    <div class="options">${optionsHTML}</div>
  `;

  testArea.appendChild(box);
});

// ================= EVALUATION =================

document.getElementById("submitBtn").addEventListener("click",()=>{

  let score=0;

  const domainScores={
    ML:0, DL:0, NLP:0, Math:0, Coding:0
  };

  questions.forEach((item,index)=>{
    const selected=document.querySelector(`input[name="q${index}"]:checked`);
    if(selected && parseInt(selected.value)===item.answer){
      score++;
      domainScores[item.domain]++;
    }
  });

  showResults(score,domainScores);
});

// ================= RESULT SCREEN =================

function showResults(score,domainScores){

  document.getElementById("resultBox").style.display="block";
  document.getElementById("submitBtn").style.display="none";

  document.getElementById("scoreText").innerText =
    "You scored "+score+" / 10";

  // Bar Chart
  new Chart(document.getElementById("barChart"),{
    type:"bar",
    data:{
      labels:Object.keys(domainScores),
      datasets:[{
        label:"Correct Answers",
        data:Object.values(domainScores),
        backgroundColor:"rgba(6,182,212,0.6)"
      }]
    }
  });

  // Radar Chart
  new Chart(document.getElementById("radarChart"),{
    type:"radar",
    data:{
      labels:Object.keys(domainScores),
      datasets:[{
        label:"Skill Distribution",
        data:Object.values(domainScores),
        borderColor:"#06b6d4",
        backgroundColor:"rgba(6,182,212,0.2)"
      }]
    }
  });
}
</script>

</body>
</html>